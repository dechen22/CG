<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curly Girl Method Ingredient Checker</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Libre+Baskerville:wght@700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #C8F0DD;
            --bg-card: #ffffff;
            --text-primary: #6B4C7A;
            --text-secondary: #8A8A8A;
            --accent-avoid: #FF8BAD;
            --accent-safe: #2D9F66;
            --accent-unknown: #8A8A8A;
            --border: #C8A8D0;
            --shadow: rgba(107, 76, 122, 0.25);
            --button-bg: #FF8BAD;
            --button-hover: #FF6B9D;
            --button-text: #6B4C7A;
            --field-bg: #F5EFE6;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: #C8F0DD;
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 32px;
            animation: fadeInDown 0.6s ease-out;
        }

        h1 {
            font-family: 'Libre Baskerville', serif;
            font-size: 28px;
            color: var(--text-primary);
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .search-container {
            position: relative;
            margin-bottom: 24px;
            animation: fadeInUp 0.6s ease-out 0.1s backwards;
        }

        .clear-button {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            font-size: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 4px;
            display: none;
            line-height: 1;
            transition: color 0.2s ease;
        }

        .clear-button.visible {
            display: block;
        }

        .clear-button:hover {
            color: var(--text-primary);
        }

        input[type="text"] {
            width: 100%;
            padding: 16px 20px;
            font-size: 16px;
            border: 3px solid var(--border);
            border-radius: 12px;
            background: var(--field-bg);
            color: var(--text-primary);
            font-family: 'DM Sans', sans-serif;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px var(--shadow);
        }

        input[type="text"]:focus {
            outline: none;
            border-color: var(--text-primary);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
        }

        .autocomplete-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-card);
            border: 2px solid var(--border);
            border-top: none;
            border-radius: 0 0 12px 12px;
            max-height: 280px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 8px 24px var(--shadow);
            display: none;
        }

        .autocomplete-list.active {
            display: block;
            animation: slideDown 0.2s ease-out;
        }

        .autocomplete-item {
            padding: 14px 20px;
            cursor: pointer;
            border-bottom: 1px solid var(--border);
            transition: all 0.2s ease;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .autocomplete-item:last-child {
            border-bottom: none;
        }

        .autocomplete-item:hover,
        .autocomplete-item.highlighted {
            background: #f5f5f5;
        }

        .autocomplete-item.avoid {
            border-left: 3px solid var(--accent-avoid);
        }

        .autocomplete-item.safe {
            border-left: 3px solid var(--accent-safe);
        }

        .autocomplete-badge {
            font-size: 12px;
            font-weight: 600;
            padding: 4px 10px;
            border-radius: 6px;
            flex-shrink: 0;
        }

        .autocomplete-badge.avoid {
            background: rgba(217, 69, 69, 0.15);
            color: var(--accent-avoid);
        }

        .autocomplete-badge.safe {
            background: rgba(45, 159, 102, 0.15);
            color: var(--accent-safe);
        }

        .result-card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 16px var(--shadow);
            margin-bottom: 24px;
            animation: fadeInUp 0.4s ease-out;
            display: none;
        }

        .result-card.show {
            display: block;
        }

        .result-status {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .status-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            flex-shrink: 0;
        }

        .status-icon.avoid {
            background: rgba(217, 69, 69, 0.15);
            color: var(--accent-avoid);
        }

        .status-icon.safe {
            background: rgba(45, 159, 102, 0.15);
            color: var(--accent-safe);
        }

        .status-icon.unknown {
            background: rgba(232, 155, 60, 0.15);
            color: var(--accent-unknown);
        }

        .result-text h2 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .result-text.avoid h2 {
            color: var(--accent-avoid);
        }

        .result-text.safe h2 {
            color: var(--accent-safe);
        }

        .result-text.unknown h2 {
            color: var(--accent-unknown);
        }

        .result-category {
            font-size: 13px;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .ingredient-name {
            font-size: 15px;
            color: var(--text-secondary);
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--border);
        }

        .legend {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px var(--shadow);
            animation: fadeInUp 0.6s ease-out 0.2s backwards;
        }

        .legend h3 {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
            font-size: 13px;
        }

        .legend-item:last-child {
            margin-bottom: 0;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .legend-dot.avoid {
            background: var(--accent-avoid);
        }

        .legend-dot.safe {
            background: var(--accent-safe);
        }

        .legend-dot.unknown {
            background: var(--accent-unknown);
        }

        /* Full Ingredient List Checker Styles */
        .section-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
            text-align: center;
        }

        .ingredient-list-container {
            margin-top: 24px;
            animation: fadeInUp 0.6s ease-out 0.15s backwards;
            position: relative;
        }

        .ingredient-list-label {
            font-size: 14px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .textarea-wrapper {
            position: relative;
        }

        .ingredient-textarea {
            width: 100%;
            min-height: 120px;
            padding: 16px 40px 16px 16px;
            background: var(--field-bg);
            border: 3px solid var(--border);
            border-radius: 10px;
            font-family: 'DM Sans', sans-serif;
            font-size: 16px;
            color: var(--text-primary);
            resize: vertical;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px var(--shadow);
        }

        .ingredient-textarea:focus {
            outline: none;
            border-color: var(--text-primary);
            box-shadow: 0 4px 12px var(--shadow);
        }

        .ingredient-textarea::placeholder {
            color: var(--text-secondary);
        }

        .clear-textarea-button {
            position: absolute;
            right: 12px;
            top: 12px;
            width: 24px;
            height: 24px;
            background: var(--text-secondary);
            color: white;
            border: none;
            border-radius: 50%;
            font-size: 16px;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            padding: 0;
            line-height: 1;
        }

        .clear-textarea-button:hover {
            background: var(--text-primary);
            transform: scale(1.1);
        }

        .clear-textarea-button.show {
            display: flex;
        }

        .check-button {
            width: 100%;
            margin-top: 12px;
            padding: 14px;
            background: var(--button-bg);
            color: var(--button-text);
            border: none;
            border-radius: 10px;
            font-family: 'DM Sans', sans-serif;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 3px 10px var(--shadow);
        }

        .check-button:hover {
            background: var(--button-hover);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px var(--shadow);
        }

        .check-button:active {
            transform: translateY(0);
        }

        .list-results {
            margin-top: 24px;
            padding: 16px;
            background: var(--bg-card);
            border-radius: 10px;
            box-shadow: 0 2px 8px var(--shadow);
            display: none;
        }

        .list-results.show {
            display: block;
            animation: fadeInUp 0.4s ease-out;
        }

        .list-results h3 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-primary);
        }

        .ingredient-item {
            padding: 2px 6px;
            margin-bottom: 0px;
            border-radius: 2px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            line-height: 1.2;
            transition: all 0.2s ease;
        }

        .ingredient-item.approved {
            background: rgba(45, 159, 102, 0.25);
            border-left: 4px solid var(--accent-safe);
        }

        .ingredient-item.not-approved {
            background: rgba(255, 139, 173, 0.3);
            border-left: 4px solid var(--accent-avoid);
        }

        .ingredient-item.unknown {
            background: transparent;
            border-left: none;
        }

        .ingredient-status {
            font-weight: 600;
            font-size: 16px;
        }

        .ingredient-status.approved {
            color: var(--accent-safe);
        }

        .ingredient-status.not-approved {
            color: var(--accent-avoid);
        }

        .results-summary {
            margin-top: 16px;
            padding-top: 12px;
            border-top: 2px solid var(--border);
        }

        .summary-item {
            padding: 6px 0;
            font-size: 14px;
            display: block;
            width: 100%;
        }

        .summary-item strong {
            font-weight: 600;
            flex-shrink: 0;
        }

        .summary-item span {
            text-align: right;
        }

        .summary-item.not-approved {
            color: var(--accent-avoid);
        }

        .summary-item.approved {
            color: var(--accent-safe);
        }

        .conclusion {
            margin-top: 12px;
            padding: 12px;
            background: rgba(255, 139, 173, 0.3);
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            font-size: 15px;
            border: 3px solid var(--accent-avoid);
        }

        .conclusion.pass {
            background: rgba(45, 159, 102, 0.25);
            color: var(--accent-safe);
            border: 3px solid var(--accent-safe);
        }

        .conclusion.fail {
            color: var(--accent-avoid);
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 24px;
            }

            .subtitle {
                font-size: 13px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Curly Girl<br>Ingredient Checker</h1>
            <p class="subtitle">Check if ingredients are Curly Girl Method approved</p>
        </header>

        <h2 class="section-title">Single Ingredient</h2>

        <div class="search-container">
            <input 
                type="text" 
                id="searchInput" 
                placeholder="Type ingredient name..."
                autocomplete="off"
            >
            <button class="clear-button" id="clearButton">✕</button>
            <div class="autocomplete-list" id="autocompleteList"></div>
        </div>

        <div class="result-card" id="resultCard">
            <div class="result-status">
                <div class="status-icon" id="statusIcon"></div>
                <div class="result-text" id="resultText">
                    <h2 id="statusTitle"></h2>
                    <div class="result-category" id="categoryName"></div>
                </div>
            </div>
            <div class="ingredient-name" id="ingredientName"></div>
        </div>

        <h2 class="section-title" style="margin-top: 40px;">Full Ingredient List</h2>

        <div class="ingredient-list-container">
            <div class="textarea-wrapper">
                <textarea 
                    id="ingredientListInput"
                    class="ingredient-textarea"
                    placeholder="Example: Water, Glycerin, Cetyl Alcohol, Dimethicone, Behentrimonium Chloride..."
                ></textarea>
                <button class="clear-textarea-button" id="clearTextareaButton">✕</button>
            </div>
            <button class="check-button" id="checkListButton">Check Ingredient List</button>
        </div>

        <div class="list-results" id="listResults">
            <h3>Ingredient List Analysis:</h3>
            <div id="ingredientAnalysis"></div>
            
            <div class="results-summary">
                <h3>Summary:</h3>
                <div id="summaryContent"></div>
            </div>
            
            <div id="conclusionDiv"></div>
        </div>
    </div>

    <script>
        const ingredientsData = {
            avoid: {
                "Strong Sulfates": [
                    "Alkylbenzene sulfonate",
                    "Alkyl Benzene Sulfonate",
                    "Ammonium laureth sulfate",
                    "Ammonium lauryl sulfate",
                    "Ammonium Xylenesulfonate",
                    "Magnesium lauryl sulfate",
                    "Sodium alkylbenzene Sulfonate",
                    "Sodium C14-16 Olefin Sulfonate",
                    "Sodium Coceth/Coco Sulfate",
                    "Sodium laureth sulfate",
                    "Sodium lauryl sulfate",
                    "Sodium myreth sulfate",
                    "Sodium Polystrene Sulfate",
                    "Sodium Xylenesulfonate",
                    "Sodium Trideceth Sulfate",
                    "TEA‑dodecylbenzenesulfonate",
                    "TEA lauryl sulfate"
                ],
                "Milder Sulfates": [
                    "Ethyl PEG‑15 cocamine sulfate",
                    "Dioctyl sodium sulfosuccinate",
                    "Disodium sulfolaurate",
                    "Pluronic and Tetronic surfactants",
                    "Sodium lauryl glucose carboxylate",
                    "Sodium methyl 2‑sulfolaurate"
                ],
                "Silicones & Other Accumulative Materials": [
                    "Aminedimethicone",
                    "Aminodimethicone",
                    "Amodimethicone",
                    "Amodimethiconol",
                    "Amodimethicone Hydroxystearate",
                    "Bees Wax",
                    "Bis‑Amino PEG/PPG‑41/3 Aminoethyl PG‑Propyl Dimethicone",
                    "Bis‑Aminopropyl Dimethicone",
                    "Bis‑Cetearyl Amodimethicone",
                    "Bis‑Phenylpropyl Dimethicone",
                    "Candelia wax",
                    "Carnauba Wax",
                    "Cera Alba",
                    "Cetearyl methicone",
                    "Cetyl Dimethicone",
                    "Cyclomethicone",
                    "Cyclopentasiloxane",
                    "Dimethicone",
                    "Dimethicone Copolymer",
                    "Dimethicone Propyl PG‑Betaine",
                    "Dimethiconol",
                    "Dimethiconol Behenoxy",
                    "Disiloxane",
                    "Hexamethyldisiloxane",
                    "Lanolin",
                    "Mineral oil",
                    "Parrifidium liquidium",
                    "Phenyl trimethicone",
                    "Petrolatum",
                    "Polysilicone‑18 Cetyl Phosphate",
                    "Silicone Quaternium‑16",
                    "Silicone Quaternium‑18",
                    "Silicone Quaternium‑22",
                    "Silicone Resin Spheres",
                    "Simethicone Stearoxy",
                    "Stearoxy Dimethicone",
                    "Stearyl Dimethicone",
                    "Trimethylsilylamodimethicone",
                    "Trisiloxane",
                    "Isododecane"
                ],
                "Drying Alcohols": [
                    "Alcohol Denat",
                    "Denatured alcohol",
                    "Ethanol",
                    "Isopropanol Alcohol",
                    "Isopropyl alcohol",
                    "Propanol",
                    "Propyl alcohol",
                    "SD alcohol",
                    "SD alcohol 40",
                    "Witch hazel"
                ]
            },
            safe: {
                "Gentle Sulfates": [
                    "Babassuamidopropyl betaine",
                    "Behentrimonium methosulfate",
                    "Cocamidopropyl betaine",
                    "Coco betaine",
                    "Cocoamphoacetate",
                    "Cocoamphodipropionate",
                    "Decyl glucoside",
                    "Disodium cocoamphodiacetate",
                    "Disodium cocoamphodipropionate",
                    "Disodium lautreth sulfosuccinate",
                    "Lauroamphoacetate",
                    "Magnesium Sulfate",
                    "Poly decyl glucoside carboxylate",
                    "Sodium cocoamphoacetate",
                    "Sodium cocoyl glutamate",
                    "Sodium cocoyl isethionate",
                    "Sodium cocoyl sarcosinate",
                    "Sodium lauroyl glutamate",
                    "Sodium Lauryl Sarcosinate",
                    "Sodium lauryl sulfoacetate",
                    "Sodium methyl cocoyl taurate",
                    "Sodium lauroamphoacetate",
                    "Sodium Lauroyl Methyl Isethionate"
                ],
                "Water‑Soluble Silicones & Related": [
                    "Benzophenone‑2‑10",
                    "DEA PG‑Propyl PEG/PPG‑18/21 Dimethicone",
                    "Dimethicone Copolyol",
                    "Dimethicone PEG‑8 Phosphate",
                    "Dimethicone‑PG Diethylmonium Chloride",
                    "Emulsifying Wax",
                    "Hydrolyzed Wheat Protein Hydroxypropyl Polysiloxane",
                    "Lauryl PEG/PPG‑18/18 Methicone",
                    "Methychloroisothiazolinone",
                    "Methylisothiazolinone",
                    "PEG‑Dimethicone",
                    "PEG‑Hydrogenated Castor Oil",
                    "Silicone Quaternium‑8"
                ],
                "Non‑Drying / Fatty Alcohols": [
                    "Behenyl alcohol",
                    "C30‑50 Alcohols",
                    "Cetearyl alcohol",
                    "Cetyl alcohol",
                    "Isocetyl alcohol",
                    "Isostearyl alcohol",
                    "Lanolin alcohol",
                    "Lauryl alcohol",
                    "Myristyl alcohol",
                    "Stearyl alcohol"
                ]
            }
        };

        // Create searchable index
        const searchIndex = [];
        
        Object.entries(ingredientsData.avoid).forEach(([category, ingredients]) => {
            ingredients.forEach(ingredient => {
                searchIndex.push({
                    name: ingredient,
                    category: category,
                    status: 'avoid'
                });
            });
        });

        Object.entries(ingredientsData.safe).forEach(([category, ingredients]) => {
            ingredients.forEach(ingredient => {
                searchIndex.push({
                    name: ingredient,
                    category: category,
                    status: 'safe'
                });
            });
        });

        // DOM elements
        const searchInput = document.getElementById('searchInput');
        const autocompleteList = document.getElementById('autocompleteList');
        const resultCard = document.getElementById('resultCard');
        const statusIcon = document.getElementById('statusIcon');
        const statusTitle = document.getElementById('statusTitle');
        const categoryName = document.getElementById('categoryName');
        const ingredientName = document.getElementById('ingredientName');
        const resultText = document.getElementById('resultText');
        const clearButton = document.getElementById('clearButton');

        let currentFocus = -1;

        // Clear button functionality
        clearButton.addEventListener('click', function() {
            searchInput.value = '';
            clearButton.classList.remove('visible');
            autocompleteList.classList.remove('active');
            resultCard.classList.remove('show');
            searchInput.focus();
        });

        // Autocomplete functionality
        searchInput.addEventListener('input', function() {
            const value = this.value.toLowerCase().trim();
            autocompleteList.innerHTML = '';
            currentFocus = -1;

            // Toggle clear button visibility
            if (value) {
                clearButton.classList.add('visible');
            } else {
                clearButton.classList.remove('visible');
            }

            if (!value) {
                autocompleteList.classList.remove('active');
                return;
            }

            const matches = searchIndex.filter(item => 
                item.name.toLowerCase().includes(value)
            ).slice(0, 8);

            if (matches.length > 0) {
                matches.forEach(match => {
                    const div = document.createElement('div');
                    div.className = `autocomplete-item ${match.status}`;
                    
                    const nameSpan = document.createElement('span');
                    nameSpan.textContent = match.name;
                    
                    const badge = document.createElement('span');
                    badge.className = `autocomplete-badge ${match.status}`;
                    badge.textContent = match.status === 'avoid' ? 'AVOID' : 'SAFE';
                    
                    div.appendChild(nameSpan);
                    div.appendChild(badge);
                    
                    div.addEventListener('click', function() {
                        selectIngredient(match);
                    });
                    autocompleteList.appendChild(div);
                });
                autocompleteList.classList.add('active');
            } else {
                autocompleteList.classList.remove('active');
            }
        });

        // Keyboard navigation
        searchInput.addEventListener('keydown', function(e) {
            const items = autocompleteList.getElementsByClassName('autocomplete-item');
            
            if (e.key === 'ArrowDown') {
                e.preventDefault();
                currentFocus++;
                addActive(items);
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                currentFocus--;
                addActive(items);
            } else if (e.key === 'Enter') {
                e.preventDefault();
                if (currentFocus > -1 && items[currentFocus]) {
                    items[currentFocus].click();
                } else if (this.value.trim()) {
                    checkIngredient(this.value.trim());
                }
            }
        });

        function addActive(items) {
            if (!items || items.length === 0) return;
            removeActive(items);
            if (currentFocus >= items.length) currentFocus = 0;
            if (currentFocus < 0) currentFocus = items.length - 1;
            items[currentFocus].classList.add('highlighted');
        }

        function removeActive(items) {
            for (let i = 0; i < items.length; i++) {
                items[i].classList.remove('highlighted');
            }
        }

        // Close autocomplete when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target !== searchInput) {
                autocompleteList.classList.remove('active');
            }
        });

        function selectIngredient(ingredient) {
            searchInput.value = ingredient.name;
            autocompleteList.classList.remove('active');
            displayResult(ingredient);
        }

        function checkIngredient(name) {
            const match = searchIndex.find(item => 
                item.name.toLowerCase() === name.toLowerCase()
            );

            if (match) {
                displayResult(match);
            } else {
                displayResult({
                    name: name,
                    category: 'Unknown ingredient',
                    status: 'unknown'
                });
            }
        }

        // New function to search ingredient and return the data (for list checker)
        function searchIngredient(name) {
            const match = searchIndex.find(item => 
                item.name.toLowerCase() === name.toLowerCase()
            );
            return match; // Returns the ingredient object or undefined
        }

        function displayResult(ingredient) {
            resultCard.classList.add('show');
            
            // Clear previous classes
            statusIcon.className = 'status-icon';
            resultText.className = 'result-text';
            
            if (ingredient.status === 'avoid') {
                statusIcon.classList.add('avoid');
                statusIcon.textContent = '❌';
                resultText.classList.add('avoid');
                statusTitle.textContent = 'Avoid';
                categoryName.textContent = ingredient.category;
            } else if (ingredient.status === 'safe') {
                statusIcon.classList.add('safe');
                statusIcon.textContent = '✓';
                resultText.classList.add('safe');
                statusTitle.textContent = 'Safe to Use';
                categoryName.textContent = ingredient.category;
            } else {
                statusIcon.classList.add('unknown');
                statusIcon.textContent = '?';
                resultText.classList.add('unknown');
                statusTitle.textContent = 'Unknown';
                categoryName.textContent = 'Not in database';
            }
            
            ingredientName.textContent = ingredient.name;
        }

        // Full Ingredient List Checker
        const ingredientListInput = document.getElementById('ingredientListInput');
        const checkListButton = document.getElementById('checkListButton');
        const clearTextareaButton = document.getElementById('clearTextareaButton');
        const listResults = document.getElementById('listResults');
        const ingredientAnalysis = document.getElementById('ingredientAnalysis');
        const summaryContent = document.getElementById('summaryContent');
        const conclusionDiv = document.getElementById('conclusionDiv');

        // Show/hide clear button based on textarea content
        ingredientListInput.addEventListener('input', function() {
            if (this.value.trim().length > 0) {
                clearTextareaButton.classList.add('show');
            } else {
                clearTextareaButton.classList.remove('show');
            }
        });

        // Add Enter key functionality for mobile and desktop
        ingredientListInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                checkIngredientList();
            }
        });

        // Clear textarea and results
        clearTextareaButton.addEventListener('click', function() {
            ingredientListInput.value = '';
            clearTextareaButton.classList.remove('show');
            listResults.classList.remove('show');
            ingredientAnalysis.innerHTML = '';
            summaryContent.innerHTML = '';
            conclusionDiv.innerHTML = '';
        });

        checkListButton.addEventListener('click', checkIngredientList);

        function checkIngredientList() {
            const inputText = ingredientListInput.value.trim();
            
            if (!inputText) {
                alert('Please paste an ingredient list');
                return;
            }

            // Split by comma and clean up
            const ingredients = inputText
                .split(',')
                .map(ing => ing.trim())
                .filter(ing => ing.length > 0);

            if (ingredients.length === 0) {
                alert('No ingredients found. Please separate ingredients by commas.');
                return;
            }

            // Analyze each ingredient
            const results = ingredients.map(ing => {
                const found = searchIngredient(ing);
                return {
                    name: ing,
                    status: found ? (found.status === 'avoid' ? 'not-approved' : 'approved') : 'unknown',
                    category: found ? found.category : null
                };
            });

            displayListResults(results);
        }

        function displayListResults(results) {
            // Clear previous results
            ingredientAnalysis.innerHTML = '';
            summaryContent.innerHTML = '';
            conclusionDiv.innerHTML = '';

            // Display each ingredient with color coding
            results.forEach(result => {
                const item = document.createElement('div');
                item.className = `ingredient-item ${result.status}`;
                
                const nameSpan = document.createElement('span');
                nameSpan.textContent = result.name;
                
                const statusSpan = document.createElement('span');
                statusSpan.className = `ingredient-status ${result.status}`;
                
                if (result.status === 'approved') {
                    statusSpan.textContent = '✓';
                } else if (result.status === 'not-approved') {
                    statusSpan.textContent = '✗';
                } else {
                    statusSpan.textContent = '';
                }
                
                item.appendChild(nameSpan);
                item.appendChild(statusSpan);
                ingredientAnalysis.appendChild(item);
            });

            // Calculate summary
            const approvedCount = results.filter(r => r.status === 'approved').length;
            const notApprovedCount = results.filter(r => r.status === 'not-approved').length;
            const notApprovedItems = results.filter(r => r.status === 'not-approved');

            // Display summary (not-approved first as requested)
            if (notApprovedCount > 0) {
                const notApprovedItem = document.createElement('div');
                notApprovedItem.className = 'summary-item not-approved';
                
                // Create list with each ingredient on its own line
                const ingredientList = notApprovedItems.map(item => 
                    `<div style="padding: 2px 0;">${item.name} <span style="color: #8A8A8A; font-size: 12px;">[${item.category}]</span></div>`
                ).join('');
                
                notApprovedItem.innerHTML = `
                    <div style="width: 100%;">
                        <div style="margin-bottom: 6px;"><strong>✗ Not Approved: ${notApprovedCount} ingredient${notApprovedCount > 1 ? 's' : ''}</strong></div>
                        <div style="font-size: 13px; padding-left: 10px;">${ingredientList}</div>
                    </div>
                `;
                summaryContent.appendChild(notApprovedItem);
            }

            if (approvedCount > 0) {
                const approvedItem = document.createElement('div');
                approvedItem.className = 'summary-item approved';
                approvedItem.innerHTML = `<strong>✓ Approved:</strong> <span>${approvedCount} ingredient${approvedCount > 1 ? 's' : ''}</span>`;
                summaryContent.appendChild(approvedItem);
            }

            // Display conclusion
            const conclusion = document.createElement('div');
            
            if (notApprovedCount > 0) {
                // If there are any not-approved ingredients, product fails
                conclusion.className = 'conclusion fail';
                conclusion.textContent = '❌ Product is NOT CGM approved';
            } else if (approvedCount > 0) {
                // If there are no not-approved ingredients AND some approved ones, it passes
                conclusion.className = 'conclusion pass';
                conclusion.textContent = '✅ Product is fully CGM approved';
            } else {
                // If all ingredients are unknown, we can't determine
                conclusion.className = 'conclusion fail';
                conclusion.textContent = '⚠ Cannot determine - all ingredients are unknown';
            }
            
            conclusionDiv.appendChild(conclusion);

            // Show results
            listResults.classList.add('show');
            
            // Scroll to results
            listResults.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }
    </script>
</body>
</html>
